---
title: "Model PC Scores"
author: "Leslie Jones"
date: "February 27, 2019"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, results='hide', message=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(lubridate)
library(psych)
library(FactoMineR)
library(ade4)
library(amap)
library(vegan)
library(knitr)
library(reshape2)
library(MASS)
library(data.table)
library(factoextra)
library (colorspace)
library (RColorBrewer)
library(ggplot2)
library(lattice)
library(readr)
library (corrplot)
setwd ("C:/Habitat_Diversity/Analysis")

```

##Model for Chinook

```{r}
#load data
pca <- read_csv("C:/Habitat_Diversity/Analysis/Data/pcscores_huc.csv")
chinook <- pca[complete.cases(pca$chinook_hab),]
View (chinook)

fit <- lm(chinook_hab ~ Avg_slope_stream + Avg_Elevation_Stream + wetland_HUC + Channel_Complexity + River_Sinuosity + Floodplain_elev + Avg_lake_elev + Avg_Elevation_HUC + CV_elevation_HUC + Avg_slope_HUC + CV_Slope_HUC + CV_Slope_Stream + Glacier_Area + Floodplain_Area + Density_lakes + forest_HUC + Shrub + wetland_HUC, data = chinook)

step <- stepAIC(fit, direction="both")
step$anova

summary (step)

#predict on full dataframe
chinook_pred <- predict(step, pca)
chinook_out <- cbind(pca,chinook_pred) 
chinook_out$chinook_pred2=(chinook_out$chinook_pred*100)
chinook_out$chinook_hab2 = (chinook_out$chinook_hab*100)
View(chinook_out)

ggplot(chinook_out, aes(x=chinook_pred2, y=chinook_hab2)) + geom_point()


write.csv(chinook_out, file="C:/Habitat_Diversity/Analysis/Data/pred_chinook.csv")
```
##Model for Sockeye

```{r}
#load data
sock <- pca[complete.cases(pca$sockeye_hab),]
View (sock)

fit <- lm(sock_hab ~ Avg_slope_stream + Avg_Elevation_Stream + wetland_HUC + Channel_Complexity + River_Sinuosity + Floodplain_elev + Avg_lake_elev + Avg_Elevation_HUC + CV_elevation_HUC + Avg_slope_HUC + CV_Slope_HUC + CV_Slope_Stream + Glacier_Area + Floodplain_Area + Density_lakes + forest_HUC + Shrub + wetland_HUC, data = sock)

step2 <- stepAIC(fit, direction="both")
step2$anova

summary (step2)

#predict on full dataframe
sock_pred <- predict(step2, pca)
sock_out <- cbind(pca,sock_pred) 
sock_out$sock_pred2=(sock_out$sock_pred*100)
sock_out$sock_hab2 = (sock_out$sock_hab*100)
View(sock_out)

ggplot(sock_out, aes(x=sock_pred2, y=sock_hab2)) + geom_point()


write.csv(sock_out, file="C:/Habitat_Diversity/Analysis/Data/pred_sock.csv")
```

##Model for Chum

```{r}
#load data
chum <- pca[complete.cases(pca$chum_hab),]
View (chum)

fit <- lm(chum_hab ~ Avg_slope_stream + Avg_Elevation_Stream + wetland_HUC + Channel_Complexity + River_Sinuosity + Floodplain_elev + Avg_lake_elev + Avg_Elevation_HUC + CV_elevation_HUC + Avg_slope_HUC + CV_Slope_HUC + CV_Slope_Stream + Glacier_Area + Floodplain_Area + Density_lakes + forest_HUC + Shrub + wetland_HUC, data = chum)

step3 <- stepAIC(fit, direction="both")
step3$anova

summary (step3)

#predict on full dataframe
chum_pred <- predict(step3, pca)
chum_out <- cbind(pca,chum_pred) 
chum_out$chum_pred2=(chum_out$chum_pred*100)
chum_out$chum_hab2 = (chum_out$chum_hab*100)
View(chum_out)

ggplot(chum_out, aes(x=chum_pred2, y=chum_hab2)) + geom_point()


write.csv(chum_out, file="C:/Habitat_Diversity/Analysis/Data/pred_chum.csv")
```

##Model for pink

```{r}
#load data
pink <- pca[complete.cases(pca$pink_hab),]
View (pink)

fit <- lm(pink_hab ~ Avg_slope_stream + Avg_Elevation_Stream + wetland_HUC + Channel_Complexity + River_Sinuosity + Floodplain_elev + Avg_lake_elev + Avg_Elevation_HUC + CV_elevation_HUC + Avg_slope_HUC + CV_Slope_HUC + CV_Slope_Stream + Glacier_Area + Floodplain_Area + Density_lakes + forest_HUC + Shrub + wetland_HUC, data = pink)

step4 <- stepAIC(fit, direction="both")
step4$anova

summary (step4)

#predict on full dataframe
pink_pred <- predict(step4, pca)
pink_out <- cbind(pca,pink_pred) 
pink_out$pink_pred2=(pink_out$pink_pred*100)
pink_out$pink_hab2 = (pink_out$pink_hab*100)
View(pink_out)

ggplot(pink_out, aes(x=pink_pred2, y=pink_hab2)) + geom_point()


write.csv(pink_out, file="C:/Habitat_Diversity/Analysis/Data/pred_pink.csv")
```

##Model for coho

```{r}
#load data
coho <- pca[complete.cases(pca$coho_hab),]
View (coho)

fit <- lm(coho_hab ~ Avg_slope_stream + Avg_Elevation_Stream + wetland_HUC + Channel_Complexity + River_Sinuosity + Floodplain_elev + Avg_lake_elev + Avg_Elevation_HUC + CV_elevation_HUC + Avg_slope_HUC + CV_Slope_HUC + CV_Slope_Stream + Glacier_Area + Floodplain_Area + Density_lakes + forest_HUC + Shrub + wetland_HUC, data = coho)

step5 <- stepAIC(fit, direction="both")
step5$anova

summary (step5)

#predict on full dataframe
coho_pred <- predict(step5, pca)
coho_out <- cbind(pca,coho_pred) 
coho_out$coho_pred2=(coho_out$coho_pred*100)
coho_out$coho_hab2 = (coho_out$coho_hab*100)
View(coho_out)

ggplot(coho_out, aes(x=coho_pred2, y=coho_hab2)) + geom_point()


write.csv(coho_out, file="C:/Habitat_Diversity/Analysis/Data/pred_coho.csv")
```